/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java project to get you started.
 * For more details take a look at the Java Quickstart chapter in the Gradle
 * user guide available at https://docs.gradle.org/4.10.2/userguide/tutorial_java_projects.html
 */

plugins {
    id 'java'
    id 'application'
	id 'nebula.ospackage' version '5.0.2'
}

def negatronVersion = '0.99.4'

// Define the main class for the application
mainClassName = 'net.babelsoft.negatron.NegatronApp'

sourceSets {
    main {
        java {
            srcDirs = ['src']
        }
    }
}

repositories {
    // Use jcenter for resolving your dependencies.
    // You can declare any Maven/Ivy/file repository here.
    jcenter()
}

dependencies {
	compile files('lib/bcprov-ext-jdk15on-152.jar','lib/jna-4.2.2.jar','lib/jna-platform-4.2.2.jar','lib/slf4j-api-1.7.10.jar','lib/stax-utils.jar','../TwelveMonkeys/common/common-image/target/twelvemonkeys-common-image-3.4-SNAPSHOT.jar','../TwelveMonkeys/common/common-io/target/twelvemonkeys-common-io-3.4-SNAPSHOT.jar','../TwelveMonkeys/common/common-lang/target/twelvemonkeys-common-lang-3.4-SNAPSHOT.jar','../TwelveMonkeys/imageio/imageio-bmp/target/twelvemonkeys-imageio-bmp-3.4-SNAPSHOT.jar','../TwelveMonkeys/imageio/imageio-core/target/twelvemonkeys-imageio-core-3.4-SNAPSHOT.jar','../TwelveMonkeys/imageio/imageio-metadata/target/twelvemonkeys-imageio-metadata-3.4-SNAPSHOT.jar','../vlcj-experimental/target/vlcj-4.0.0-SNAPSHOT.jar','../OpenViewerFX/dist/OpenViewerFX.jar','../Negatron-Preloader/dist/Negatron-Preloader.jar')
	
    testCompile 'junit:junit:4.12'
}

jar {
	manifest {
		attributes(
			'Manifest-Version'     	: '1.0',
			'Implementation-Title' 	: 'Negatron',
			'Implementation-Version': negatronVersion,
			'Implementation-Vendor'	: 'BabelSoft',
			'JavaFX-Preloader-Class': 'net.babelsoft.negatron.preloader.NegatronPreloader',
			'Permissions'			: 'all-permissions',
			'JavaFX-Version'		: '8.0',
			'Main-Class'           	: 'net.babelsoft.negatron.NegatronApp',
			'Class-Path'           	: configurations.compile.collect { 'lib/' + it.getName() }.join(' ')
		)
	}
}

ospackage {
	packageName 'negatron'
	packageDescription 'Negatron: a user-friendly front-end for MAME'
	version negatronVersion
	release '1'
	type= BINARY
	license 'GPL-3'
	vendor 'BabelSoft'
	packager 'BabelSoft'
	maintainer 'BabelSoft'
	user 'root'
	permissionGroup 'root'
	into '/opt/negatron'
	url 'http://www.babelsoft.net/products/negatron.htm'
	from (configurations.compile) {
		into('lib')
	}
	from ('lib/bcmail-jdk15on-152.jar') {
		into('lib')
	}
	from ('lib/bcpg-jdk15on-152.jar') {
		into('lib')
	}
	from ('lib/bcpkix-jdk15on-152.jar') {
		into('lib')
	}
	from ('lib/rhino-1.7.6.jar') {
		into('lib')
	}
	from (jar)
	from ('theme') {
		into('theme')
	}
	from ('Negatron.sh')
	from ('Negatron Manual v' + negatronVersion + '.pdf')
	from ('readme-v' + negatronVersion + '.txt')
	from ('license.txt')
}

buildRpm {
	requires('java-1.8.0-openjdk')
	requires('java-1.8.0-openjdk-openjfx')
	requires('vlc', '2.2', GREATER | EQUAL)
	arch = NOARCH
	os = LINUX
	addParentDirs = false
	createDirectoryEntry = false
}

buildDeb {
	requires('openjdk-8-jre')
	requires('openjfx')
	requires('vlc', '2.2', GREATER | EQUAL)
	arch = "all"
}

build.dependsOn buildRpm
build.dependsOn buildDeb